{"ast":null,"code":"var _jsxFileName = \"/home/beleshivprasad/Desktop/inhouse_internship/source_code/src/Pages/Payments/PaymentPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Button, Col, Container, Row, Table } from \"react-bootstrap\";\nimport { useHistory } from \"react-router-dom\";\nimport MainScreen from \"../../Components/MainScreen\";\nimport Loading from \"../../Components/Loading\";\nimport ErrorMessage from \"../../Components/ErrorMessage\";\nimport SuccessMessage from \"../../Components/SuccessMessage\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst PaymentPage = () => {\n  _s();\n\n  const history = useHistory();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [paymentInfo, setPaymentInfo] = useState(JSON.parse(localStorage.getItem(\"paymentInfo\")));\n  const [data, setData] = useState(JSON.parse(localStorage.getItem(\"student\")));\n  const [fname, setFname] = useState(data === null || data === void 0 ? void 0 : data.fname);\n  const [lname, setLname] = useState(data === null || data === void 0 ? void 0 : data.lname);\n  const [email, setEmail] = useState(data === null || data === void 0 ? void 0 : data.email);\n  const [phone, setPhone] = useState(data === null || data === void 0 ? void 0 : data.phone);\n  const [cetID, setCetID] = useState(data === null || data === void 0 ? void 0 : data.cetID);\n  const [payment, setPayment] = useState(data === null || data === void 0 ? void 0 : data.paymentDone);\n  const [paymentId, setPaymentId] = useState(data === null || data === void 0 ? void 0 : data.paymentId);\n  const [show, setShow] = useState(!localStorage.getItem('show'));\n\n  const loadScript = src => {\n    return new Promise(resolve => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n\n      script.onload = () => {\n        resolve(true);\n      };\n\n      script.onerror = () => {\n        resolve(false);\n      };\n\n      document.body.appendChild(script);\n    });\n  };\n\n  const getPaymentInfo = async e => {\n    e.preventDefault();\n\n    try {\n      const config = {\n        headers: {\n          \"Content-type\": \"application/json\"\n        }\n      };\n      setLoading(true);\n      const {\n        data\n      } = await axios.post(\"/student/razorpay\", config);\n      setPaymentInfo(data);\n      localStorage.setItem(\"paymentInfo\", JSON.stringify(data));\n      console.log(data);\n      setLoading(false);\n    } catch (error) {\n      setError(error.response.data.message);\n      setLoading(false);\n      setTimeout(() => {\n        setError(false);\n      }, 3000);\n    }\n  };\n\n  const displayRazorpay = async e => {\n    e.preventDefault();\n    const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n\n    if (!res) {\n      setError(\"Failed Loading Razorpay\");\n    } else {\n      const options = {\n        key: \"rzp_test_T2w19cF6gqmZQa\",\n        amount: 100 * 1000,\n        currency: \"INR\",\n        name: \"Walchand Collge of Engineering, Sangli\",\n        description: \"Spot Round Fee Payment\",\n        image: \"https://img.collegepravesh.com/2018/11/WCE-Sangli-Logo.png\",\n        order_id: paymentInfo.id,\n        handler: async response => {\n          alert(response.razorpay_payment_id);\n          setPaymentId(response.razorpay_payment_id);\n          setPayment(true);\n\n          try {\n            const config = {\n              headers: {\n                \"Content-type\": \"application/json\"\n              }\n            };\n            setLoading(true);\n            const orderId = paymentInfo.id;\n            const {\n              data\n            } = await axios.post(\"/student/fetch\", {\n              orderId\n            }, config);\n            console.log(data[0].id);\n            const updatePayment = await axios.post(\"/student/updatepayment\", {\n              fname,\n              lname,\n              cetID,\n              paymentId: orderId\n            });\n            localStorage.setItem(\"student\", JSON.stringify(updatePayment));\n            console.log(data[0].id, response.razorpay_payment_id);\n\n            if (data[0].id.normalize() === response.razorpay_payment_id.normalize()) {\n              setSuccess(\"Payment Successfull\");\n            } else {\n              setError(\"Payment Failed\");\n            }\n\n            setTimeout(() => {\n              setError(false);\n              setSuccess(false);\n            }, 3000);\n            setLoading(false);\n          } catch (error) {\n            setError(error.response.data.message);\n            setLoading(false);\n            setTimeout(() => {\n              setError(false);\n            }, 3000);\n          }\n        },\n        prefill: {\n          name: `${fname} ${lname}`,\n          email: email,\n          contact: `91${phone}`\n        },\n        notes: {\n          address: \"Razorpay Corporate Office\"\n        },\n        theme: {\n          color: \"#3399cc\"\n        }\n      };\n      const rzp = new window.Razorpay(options);\n      rzp.open();\n      e.preventDefault();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(MainScreen, {\n    title: \"Spot Round Fee Payment\",\n    children: [error && /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      variant: \"danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }, this), success && /*#__PURE__*/_jsxDEV(SuccessMessage, {\n      variant: \"success\",\n      children: success\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 19\n    }, this), loading && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      fluid: true,\n      children: [typeof show, (data === null || data === void 0 ? void 0 : data.paymentDone) === false && !show ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              textAlign: \"center\"\n            },\n            children: \"You are going to pay Rs 1000/- to Walchand College of Engineering\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                onClick: e => {\n                  getPaymentInfo(e).then(() => {\n                    setShow(false);\n                  });\n                },\n                children: \"Proceed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                variant: \"danger\",\n                onClick: e => {\n                  localStorage.removeItem(\"paymentInfo\");\n                  history.push(\"/status\");\n                },\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  style: {\n                    width: \"50vw\"\n                  },\n                  colSpan: 2,\n                  children: /*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \" Payment Details\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 207,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  style: {\n                    width: \"50vw\"\n                  },\n                  children: \"Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  style: {\n                    width: \"50vw\"\n                  },\n                  children: [fname === null || fname === void 0 ? void 0 : fname.toUpperCase(), \" \", lname === null || lname === void 0 ? void 0 : lname.toUpperCase()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"Email\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"Mobile Number\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: phone\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"Amount To Pay\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 225,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: [(paymentInfo === null || paymentInfo === void 0 ? void 0 : paymentInfo.amount) / 100, \" Rs\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 226,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 19\n              }, this), paymentId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: \"ID\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 231,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: paymentId === null || paymentId === void 0 ? void 0 : paymentId.slice(6, 20)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  children: \"Status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: payment ? \"Done\" : \"Pending\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 13\n        }, this), payment ? /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"button\",\n                  onClick: e => {\n                    displayRazorpay(e);\n                  },\n                  children: \"Pay\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"button\",\n                  variant: \"danger\",\n                  onClick: e => {\n                    localStorage.removeItem(\"paymentInfo\");\n                    history.push(\"/status\");\n                  },\n                  children: \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 17\n          }, this)\n        }, void 0, false)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PaymentPage, \"dD5neCSyr5bY8umkgklVK03q1Ps=\", false, function () {\n  return [useHistory];\n});\n\n_c = PaymentPage;\nexport default PaymentPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentPage\");","map":{"version":3,"sources":["/home/beleshivprasad/Desktop/inhouse_internship/source_code/src/Pages/Payments/PaymentPage.js"],"names":["React","useState","Button","Col","Container","Row","Table","useHistory","MainScreen","Loading","ErrorMessage","SuccessMessage","axios","PaymentPage","history","loading","setLoading","error","setError","success","setSuccess","paymentInfo","setPaymentInfo","JSON","parse","localStorage","getItem","data","setData","fname","setFname","lname","setLname","email","setEmail","phone","setPhone","cetID","setCetID","payment","setPayment","paymentDone","paymentId","setPaymentId","show","setShow","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","getPaymentInfo","e","preventDefault","config","headers","post","setItem","stringify","console","log","response","message","setTimeout","displayRazorpay","res","options","key","amount","currency","name","description","image","order_id","id","handler","alert","razorpay_payment_id","orderId","updatePayment","normalize","prefill","contact","notes","address","theme","color","rzp","window","Razorpay","open","textAlign","then","removeItem","push","width","toUpperCase","slice"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Col, Container, Row, Table } from \"react-bootstrap\";\nimport { useHistory } from \"react-router-dom\";\nimport MainScreen from \"../../Components/MainScreen\";\nimport Loading from \"../../Components/Loading\";\nimport ErrorMessage from \"../../Components/ErrorMessage\";\nimport SuccessMessage from \"../../Components/SuccessMessage\";\nimport axios from \"axios\";\n\nconst PaymentPage = () => {\n  const history = useHistory();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [paymentInfo, setPaymentInfo] = useState(\n    JSON.parse(localStorage.getItem(\"paymentInfo\"))\n  );\n  const [data, setData] = useState(JSON.parse(localStorage.getItem(\"student\")));\n  const [fname, setFname] = useState(data?.fname);\n  const [lname, setLname] = useState(data?.lname);\n  const [email, setEmail] = useState(data?.email);\n  const [phone, setPhone] = useState(data?.phone);\n  const [cetID, setCetID] = useState(data?.cetID);\n  const [payment, setPayment] = useState(data?.paymentDone);\n  const [paymentId, setPaymentId] = useState(data?.paymentId);\n\n  const [show, setShow] = useState(!localStorage.getItem('show'));\n\n\n\n  const loadScript = (src) => {\n    return new Promise((resolve) => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n      script.onload = () => {\n        resolve(true);\n      };\n      script.onerror = () => {\n        resolve(false);\n      };\n      document.body.appendChild(script);\n    });\n  };\n\n  const getPaymentInfo = async (e) => {\n    e.preventDefault();\n    try {\n      const config = {\n        headers: {\n          \"Content-type\": \"application/json\",\n        },\n      };\n\n      setLoading(true);\n      const { data } = await axios.post(\"/student/razorpay\", config);\n      setPaymentInfo(data);\n      localStorage.setItem(\"paymentInfo\", JSON.stringify(data));\n      console.log(data);\n      setLoading(false);\n    } catch (error) {\n      setError(error.response.data.message);\n      setLoading(false);\n      setTimeout(() => {\n        setError(false);\n      }, 3000);\n    }\n  };\n\n  const displayRazorpay = async (e) => {\n    e.preventDefault();\n    const res = await loadScript(\n      \"https://checkout.razorpay.com/v1/checkout.js\"\n    );\n    if (!res) {\n      setError(\"Failed Loading Razorpay\");\n    } else {\n      const options = {\n        key: \"rzp_test_T2w19cF6gqmZQa\",\n        amount: 100 * 1000,\n        currency: \"INR\",\n        name: \"Walchand Collge of Engineering, Sangli\",\n        description: \"Spot Round Fee Payment\",\n        image: \"https://img.collegepravesh.com/2018/11/WCE-Sangli-Logo.png\",\n        order_id: paymentInfo.id,\n        handler: async (response) => {\n          alert(response.razorpay_payment_id);\n          setPaymentId(response.razorpay_payment_id);\n          setPayment(true);\n          try {\n            const config = {\n              headers: {\n                \"Content-type\": \"application/json\",\n              },\n            };\n\n            setLoading(true);\n            const orderId = paymentInfo.id;\n            const { data } = await axios.post(\n              \"/student/fetch\",\n              { orderId },\n              config\n            );\n            console.log(data[0].id);\n            const updatePayment = await axios.post(\"/student/updatepayment\", {\n              fname,\n              lname,\n              cetID,\n              paymentId: orderId,\n            });\n            localStorage.setItem(\"student\", JSON.stringify(updatePayment));\n\n            console.log(data[0].id, response.razorpay_payment_id);\n            if (\n              data[0].id.normalize() ===\n              response.razorpay_payment_id.normalize()\n            ) {\n              setSuccess(\"Payment Successfull\");\n            } else {\n              setError(\"Payment Failed\");\n            }\n            setTimeout(() => {\n              setError(false);\n              setSuccess(false);\n            }, 3000);\n            setLoading(false);\n          } catch (error) {\n            setError(error.response.data.message);\n            setLoading(false);\n            setTimeout(() => {\n              setError(false);\n            }, 3000);\n          }\n        },\n        prefill: {\n          name: `${fname} ${lname}`,\n          email: email,\n          contact: `91${phone}`,\n        },\n        notes: {\n          address: \"Razorpay Corporate Office\",\n        },\n        theme: {\n          color: \"#3399cc\",\n        },\n      };\n      const rzp = new window.Razorpay(options);\n      rzp.open();\n      e.preventDefault();\n    }\n  };\n  return (\n    <MainScreen title={\"Spot Round Fee Payment\"}>\n      {error && <ErrorMessage variant=\"danger\">{error}</ErrorMessage>}\n      {success && <SuccessMessage variant=\"success\">{success}</SuccessMessage>}\n      {loading && <Loading></Loading>}\n      <Container fluid>\n        {typeof show}\n        {data?.paymentDone ===false && !show ? (\n          <>\n            <br />\n            <br />\n            <Row>\n              <h3 style={{ textAlign: \"center\" }}>\n                You are going to pay Rs 1000/- to Walchand College of\n                Engineering\n              </h3>\n            </Row>\n            <br />\n            <Row>\n              <Col>\n                <Row>\n                  <Button\n                    type=\"button\"\n                    onClick={(e) => {\n                      getPaymentInfo(e).then(() => {\n                        setShow(false);\n                      });\n                    }}\n                  >\n                    Proceed\n                  </Button>\n                </Row>\n              </Col>\n              <Col>\n                <Row>\n                  <Button\n                    type=\"button\"\n                    variant=\"danger\"\n                    onClick={(e) => {\n                      localStorage.removeItem(\"paymentInfo\");\n                      history.push(\"/status\");\n                    }}\n                  >\n                    Cancel\n                  </Button>\n                </Row>\n              </Col>\n            </Row>\n          </>\n        ) : (\n          <>\n            <Row>\n              <Table>\n                <tbody>\n                  <tr>\n                    <td style={{ width: \"50vw\" }} colSpan={2}>\n                      <b> Payment Details</b>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td style={{ width: \"50vw\" }}>Name</td>\n                    <td style={{ width: \"50vw\" }}>\n                      {fname?.toUpperCase()} {lname?.toUpperCase()}\n                    </td>\n                  </tr>\n                  <tr>\n                    <td>Email</td>\n                    <td>{email}</td>\n                  </tr>\n                  <tr>\n                    <td>Mobile Number</td>\n                    <td>{phone}</td>\n                  </tr>\n                  <tr>\n                    <td>Amount To Pay</td>\n                    <td>{paymentInfo?.amount / 100} Rs</td>\n                  </tr>\n                  {paymentId ? (\n                    <>\n                      <tr>\n                        <td>ID</td>\n                        <td>{paymentId?.slice(6, 20)}</td>\n                      </tr>\n                    </>\n                  ) : (\n                    <></>\n                  )}\n                  <tr>\n                    <td>Status</td>\n                    <td>{payment ? \"Done\" : \"Pending\"}</td>\n                  </tr>\n                </tbody>\n              </Table>\n            </Row>\n            {payment ? (\n              <></>\n            ) : (\n              <>\n                <Row>\n                  <Col>\n                    <Row>\n                      <Button\n                        type=\"button\"\n                        onClick={(e) => {\n                          displayRazorpay(e);\n                        }}\n                      >\n                        Pay\n                      </Button>\n                    </Row>\n                  </Col>\n                  <Col>\n                    <Row>\n                      <Button\n                        type=\"button\"\n                        variant=\"danger\"\n                        onClick={(e) => {\n                          localStorage.removeItem(\"paymentInfo\");\n                          history.push(\"/status\");\n                        }}\n                      >\n                        Cancel\n                      </Button>\n                    </Row>\n                  </Col>\n                </Row>\n              </>\n            )}\n          </>\n        )}\n      </Container>\n    </MainScreen>\n  );\n};\n\nexport default PaymentPage;\n"]},"metadata":{},"sourceType":"module"}